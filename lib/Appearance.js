function initAppearance(){var csInterface=new CSInterface();updateThemeWithAppSkinInfo(csInterface.hostEnvironment.appSkinInfo);console.dir(csInterface.hostEnvironment);csInterface.addEventListener(CSInterface.THEME_COLOR_CHANGED_EVENT,onAppThemeColorChanged);}function updateThemeWithAppSkinInfo(appSkinInfo){var panelBackgroundColor=appSkinInfo.panelBackgroundColor.color;document.body.bgColor=toHex(panelBackgroundColor);var styleId="adobestyle";var gradientBg="background-color: "+toHex(panelBackgroundColor,0);var gradientDisabledBg="background-color: "+toHex(panelBackgroundColor,-20);var isPanelThemeLight=panelBackgroundColor.red>100;var fontColor,disabledFontColor,buttonHighlightColor,titleFontColor,selectionColor;var borderColor,importantBorderColor;var inputBackgroundColor,inputBorderColor;var gradientHighlightBg,importBackgroundColor;var svgFillColor;if(isPanelThemeLight){fontColor="color: "+toHex(panelBackgroundColor,-120)+";";disabledFontColor="color:"+toHex(panelBackgroundColor,-70)+";";buttonHighlightColor="color: white;";titleFontColor="color: "+toHex(panelBackgroundColor,-180)+";";selectionColor="color: black;";borderColor="border-color: "+toHex(panelBackgroundColor,-90)+";";importantBorderColor="border-color: black";inputBackgroundColor="background-color: "+toHex(panelBackgroundColor,54)+";";inputBorderColor="border-color: "+toHex(panelBackgroundColor,-30)+";";gradientHighlightBg="background-color: "+toHex(panelBackgroundColor,-90)+";";importBackgroundColor="background-color: black;";svgFillColor="fill: "+toHex(panelBackgroundColor,-120)+";";}else{fontColor="color: "+toHex(panelBackgroundColor,120)+";";disabledFontColor="color:"+toHex(panelBackgroundColor,100)+";";buttonHighlightColor="color: black;";titleFontColor="color: "+toHex(panelBackgroundColor,180)+";";selectionColor="color: white;";borderColor="border-color: "+toHex(panelBackgroundColor,90)+";";importantBorderColor="border-color: white";inputBackgroundColor="background-color: "+toHex(panelBackgroundColor,-10)+";";inputBorderColor="border-color: "+toHex(panelBackgroundColor,30)+";";gradientHighlightBg="background-color: "+toHex(panelBackgroundColor,90)+";";importBackgroundColor="background-color: white;";svgFillColor="fill: "+toHex(panelBackgroundColor,180)+";";}var parser=require('ua-parser-js');var ua=parser(navigator.userAgent);var baseFontFamily=(ua.os.name=="Mac OS")?"Lucida Grande":"Tahoma";addRule(styleId,"body","font-size:"+(appSkinInfo.baseFontSize)+"px;");addRule(styleId,"body",fontColor);addRule(styleId,"body","font-family: "+baseFontFamily+", Arial, sans-serif;");addRule(styleId,".title","font-size:"+(appSkinInfo.baseFontSize+5)+"px;");addRule(styleId,".title",titleFontColor);addRule(styleId,".warning",selectionColor);addRule(styleId,".warning",inputBorderColor);addRule(styleId,".warning",inputBackgroundColor);addRule(styleId,".tab",titleFontColor);addRule(styleId,".tab.default",fontColor);addRule(styleId,"svg",svgFillColor);addRule(styleId,".md-select [type=button]:enabled:active",gradientHighlightBg);addRule(styleId,".md-select ul[role=listbox]","background-color: "+toHex(panelBackgroundColor,0)+";");addRule(styleId,".md-select ul[role=listbox] li:focus, .md-select ul[role=listbox] li:hover, .md-select ul[role=listbox] li.active",selectionColor);addRule(styleId,"button, select, input[type=text], input[type=password], input[type=button], input[type=submit]",borderColor);addRule(styleId,"button.important-button",selectionColor);addRule(styleId,"button.important-button",importantBorderColor);addRule(styleId,"button:enabled:active.important-button",importBackgroundColor);addRule(styleId,"p",fontColor);addRule(styleId,"code",fontColor);addRule(styleId,"button",fontColor);addRule(styleId,"button","font-family: "+baseFontFamily+", Arial, sans-serif;");addRule(styleId,"button","font-size:"+(appSkinInfo.baseFontSize)+"px;");addRule(styleId,"button, select, input[type=button], input[type=submit]",gradientBg);addRule(styleId,"button:enabled:active, input[type=button]:enabled:active, input[type=submit]:enabled:active",gradientHighlightBg);addRule(styleId,"button:enabled:active, input[type=button]:enabled:active, input[type=submit]:enabled:active",buttonHighlightColor);addRule(styleId,"input[disabled]",gradientDisabledBg);addRule(styleId,"input[disabled]",disabledFontColor);addRule(styleId,"input[type=text], input[type=password]","font-size:"+(appSkinInfo.baseFontSize)+"px;");addRule(styleId,"input[type=text], input[type=password]","font-family: "+baseFontFamily+", Arial, sans-serif;");addRule(styleId,"input[type=text], input[type=password]",titleFontColor);addRule(styleId,"input[type=text], input[type=password]",inputBackgroundColor);addRule(styleId,"input[type=text], input[type=password]",inputBorderColor);addRule(styleId,"a",titleFontColor);}function addRule(stylesheetId,selector,rule){var stylesheet=document.getElementById(stylesheetId);if(stylesheet){stylesheet=stylesheet.sheet;if(stylesheet.addRule)stylesheet.addRule(selector,rule);else if(stylesheet.insertRule)stylesheet.insertRule(selector+' { '+rule+' }',stylesheet.cssRules.length);}}function toHex(color,delta){function computeValue(value,delta){var computedValue=!isNaN(delta)?value+delta:value;if(computedValue<0)computedValue=0;else if(computedValue>255)computedValue=255;computedValue=Math.round(computedValue).toString(16);return computedValue.length==1?"0"+computedValue:computedValue;}var hex="";if(color){with(color)hex=computeValue(red,delta)+computeValue(green,delta)+computeValue(blue,delta);;}return "#"+hex;}function onAppThemeColorChanged(event){var skinInfo=JSON.parse(window.__adobe_cep__.getHostEnvironment()).appSkinInfo;updateThemeWithAppSkinInfo(skinInfo);}